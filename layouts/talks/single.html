{{ define "main" }}
{{ $enable_toc := and (.Params.toc | default site.Params.toc) (gt (len .TableOfContents) 100) }}
{{ $lang := .Site.Language.Lang }}
{{ $page := . }}

<article class="px-1" id="talk" data-toc="true">
  <header>
    <h1 class="dynamic-title">{{ .Title }}</h1>
    <!-- Featured image -->
    <div class="d-flex justify-content-between">
      {{ with .Params.image }}
      {{ $src := $page.Resources.GetMatch ( .path | default . ) }}
      {{ $src = printf "src=\"%s\"" $src.RelPermalink }}
      {{ $class := "class=\"preview-img" }}
      {{ if .no_bg }}{{ $class = printf "%s no-bg\"" $class }}{{ else }}{{ $class = printf "%s\"" $class }}{{ end }}
      {{ $alt := printf "alt=\"%s\"" ( .alt | default "Preview Image" ) }}

      {{ $lqip := "" }}
      {{ with .lqip }}{{ $lqip = printf "lqip=\"%s\"" . }}{{ end }}

      <div class="mt-3 mb-3">
        <img {{ $src | safeHTMLAttr }} {{ $class | safeHTMLAttr }} {{ $alt | safeHTMLAttr }} w="1200" h="630" {{ $lqip |
          safeHTMLAttr }}>
        {{- with .alt -}}
        <figcaption class="text-center pt-2 pb-2">{{ . }}</figcaption>
        {{- end -}}
      </div>
      {{ end }}
    </div>

    <!-- Talk metadata -->
    <div class="d-flex justify-content-between align-items-center">
      <div class="post-meta text-muted">
        <!-- Date -->
        <span>
          <i class="far fa-calendar fa-fw me-1"></i>
          <time datetime="{{ .Date | time.Format " 2006-01-02T15:04:05Z07:00" }}">
            {{ .Date | time.Format (.Site.Params.dateFormat.post | default "Jan 2, 2006") }}
          </time>
        </span>

        <!-- Event -->
        {{ if .Params.event }}
        <span class="ms-3">
          <i class="fas fa-calendar-alt fa-fw me-1"></i>{{ .Params.event }}
        </span>
        {{ end }}

        <!-- Location -->
        {{ if .Params.location }}
        <span class="ms-3">
          <i class="fas fa-map-marker-alt fa-fw me-1"></i>{{ .Params.location }}
        </span>
        {{ end }}

        <!-- Duration (for workshops) -->
        {{ if .Params.duration }}
        <span class="ms-3">
          <i class="far fa-clock fa-fw me-1"></i>{{ .Params.duration }}
        </span>
        {{ end }}

        <!-- Level (for workshops) -->
        {{ if .Params.level }}
        <span class="ms-3">
          <i class="fas fa-signal fa-fw me-1"></i>{{ .Params.level }}
        </span>
        {{ end }}
      </div>
    </div>
  </header>

  <!-- Main content -->
  <div class="content">
    {{ .Content }}
  </div>
  {{ end }}